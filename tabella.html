<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestione Ticket</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f5f5f5; }
.container { max-width: 1400px; margin: 2rem auto; padding: 1rem; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 0.5rem; border: 1px solid #ccc; text-align: center; font-size: 0.85rem; }
thead { background: #1e3a8a; color: #fff; }
button { cursor: pointer; }
</style>
</head>
<body>

<div class="container">
    <h1 class="text-2xl font-bold mb-4">Gestione Ticket</h1>
    <div class="mb-4">
        <button onclick="window.location.href='ticket.html'" class="bg-blue-600 text-white px-4 py-2 rounded shadow">Nuovo Ticket</button>
    </div>

    <table id="ticketTable">
        <thead>
            <tr>
                <th>Nr Ticket</th>
                <th>Stato</th>
                <th>Tipo</th>
                <th>Bloccante</th>
                <th>Priorit√†</th>
                <th>Data Inserimento</th>
                <th>Ambito</th>
                <th>Menu</th>
                <th>Titolo</th>
                <th>Descrizione</th>
                <th>Inserito da</th>
                <th>In carico a</th>
                <th>Data Inizio Prevista</th>
                <th>Data Fine Prevista</th>
                <th>Data Rilascio</th>
                <th>Descrizione Soluzione</th>
                <th>Data Segnalato</th>
                <th>Data Preso in carico</th>
                <th>Data Rilasciato</th>
                <th>Data in Test</th>
                <th>Data Completato</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<script>
let tickets = JSON.parse(localStorage.getItem('tickets') || '[]');

function renderTable() {
    const tbody = document.querySelector('#ticketTable tbody');
    tbody.innerHTML = '';
    tickets.forEach((t, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${i+1}</td>
            <td>${t.stato || ''}</td>
            <td>${t.tipo || ''}</td>
            <td>${t.bloccante || ''}</td>
            <td>${t.priorita || ''}</td>
            <td>${t.dataInserimento || ''}</td>
            <td>${t.ambito || ''}</td>
            <td>${t.menu || ''}</td>
            <td>${t.titolo || ''}</td>
            <td>${t.descrizione || ''}</td>
            <td>${t.inseritoDa || ''}</td>
            <td>${t.inCaricoA || ''}</td>
            <td>${t.dataInizioPrevista || ''}</td>
            <td>${t.dataFinePrevista || ''}</td>
            <td>${t.dataRilascio || ''}</td>
            <td>${t.descrizioneSoluzione || ''}</td>
            <td>${t.dataSegnalato || ''}</td>
            <td>${t.dataPresoInCarico || ''}</td>
            <td>${t.dataRilasciato || ''}</td>
            <td>${t.dataInTest || ''}</td>
            <td>${t.dataCompletato || ''}</td>
            <td><button onclick="editTicket(${i})" class="bg-yellow-500 text-white px-2 py-1 rounded">Modifica</button></td>
        `;
        tbody.appendChild(tr);
    });
}

function editTicket(index) {
    localStorage.setItem('editTicketIndex', index);
    window.location.href = 'ticket.html';
}

renderTable();
</script>
</body>
</html>
